{% extends "reportes/reporte_base.html" %}

{% block graficos_js %}
<script>
document.addEventListener("DOMContentLoaded", function() {
  // Filtramos las filas que no queremos en el gráfico de torta
  const labelsTorta = [
    {% for row in data.rows %}
      {% if row.0 != "Total Partos" %}
        "{{ row.0 }}",
      {% endif %}
    {% endfor %}
  ];
  const valoresTorta = [
    {% for row in data.rows %}
      {% if row.0 != "Total Partos" %}
        {{ row.1 }},
      {% endif %}
    {% endfor %}
  ];

  const colores = [
    "#198754","#dc3545","#ffc107","#0d6efd","#6f42c1",
    "#fd7e14","#20c997","#6610f2","#e83e8c","#17a2b8"
  ];

  // Gráfico de barras (usa todas las filas, incluyendo total)
  const labelsBarras = [{% for row in data.rows %}"{{ row.0 }}",{% endfor %}];
  const valoresBarras = [{% for row in data.rows %}{{ row.1 }},{% endfor %}];

  new Chart(document.getElementById("graficoBarras"), {
    type: "bar",
    data: { labels: labelsBarras, datasets:[{ data: valoresBarras, backgroundColor: colores }] },
    options: { responsive:true, maintainAspectRatio:false, plugins:{ legend:{ display:false } }, scales:{ y:{ beginAtZero:true } } }
  });

  // Gráfico de torta (excluye "Total Partos")
  new Chart(document.getElementById("graficoTorta"), {
    type: "pie",
    data: { labels: labelsTorta, datasets:[{ data: valoresTorta, backgroundColor: colores }] },
    options: { responsive:true, maintainAspectRatio:false, plugins:{ legend:{ position:'bottom' } } }
  });
});
</script>
{% endblock %}